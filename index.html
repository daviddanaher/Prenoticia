<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Barra Flotante Login</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; }

    .floating-bar {
      position: fixed;
      top: 50px;
      left: 0;
      width: 100%;
      background: #f68e03;
      border-radius: 0 0 8px 8px;
      opacity: 0;
      pointer-events: none;
      transform: translateY(-10px);
      transition: all 0.4s ease;
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .floating-bar.visible {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .content-wrapper {
      max-width: 1100px;
      width: 100%;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .login-button,
    .subscribe-button,
    .info-button,
    .login-error,
    #submitLogin,
    #closeLoginBtn,
    .account-button {
      height: 36px;
      border-radius: 18px;
      display: flex;
      align-items: center;
      padding: 0 14px;
      font-size: 14px;
      border: none;
      cursor: pointer;
    }

    .login-button { background: #444; color: white; }
    .account-button { background: #0077cc; color: white; }
    .info-button { background: #eee; color: #444; }
    .subscribe-button {
      background: gold;
      color: #222;
      margin-left: auto;
    }

    .subscribe-button::before {
      content: "‚≠ê ";
      font-size: 16px;
    }

    #emailInput {
      display: none;
      height: 36px;
      border-radius: 18px;
      border: none;
      padding: 0 12px;
      font-size: 14px;
      flex-grow: 1;
      max-width: 300px;
    }

    #loginError {
      display: none;
      background: #d32f2f;
      color: white;
      padding: 0 14px;
      border-radius: 18px;
      align-items: center;
      font-weight: bold;
      flex-grow: 1;
      justify-content: space-between;
    }

    #loginError span { flex-grow: 1; }
    .close-error {
      background: transparent;
      color: white;
      border: none;
      font-size: 18px;
      cursor: pointer;
      margin-left: 10px;
    }

    .hidden { display: none !important; }

    @media (max-width: 768px) {
      .floating-bar {
        border-radius: 0;
      }
    }
  </style>
</head>
<body>

<!-- Barra de usuario logueado -->
<div class="floating-bar" id="userBar">
  <div class="content-wrapper">
    <span id="userName">Hola, Usuario</span>
    <button class="account-button" onclick="viewAccount()">Mi cuenta</button>
    <button class="login-button" onclick="logout()">Cerrar sesi√≥n</button>
  </div>
</div>

<!-- Barra de login -->
<div class="floating-bar" id="authBar">
  <div class="content-wrapper">

    <div id="loginError" class="login-error">
      <span id="errorMessage">Error</span>
      <button class="close-error" onclick="resetLoginState()">&times;</button>
    </div>

    <div id="loginContainer">
      <button id="loginToggle" class="login-button">üë§ Iniciar sesi√≥n</button>
      <input type="email" id="emailInput" placeholder="Ingres√° tu email" />
      <button id="submitLogin" class="login-button">Ingresar</button>
      <button id="closeLoginBtn" class="login-button">&times;</button>
    </div>

    <a id="subscribeButton" class="subscribe-button" href="https://www.prenoticia.com/p/suscribirme-prenoticia.html">Suscribite</a>
    <button id="infoBtn" class="info-button">‚ÑπÔ∏è Info</button>

  </div>
</div>

<script>
  const users = {
    "mauricioacostacom@gmail.com": {
      nombre: "Mauricio David",
      apellido: "Acosta Danaher",
      correo: "mauricioacostacom@gmail.com",
      medio: "Mercado Pago",
      estado: "activo",
      tipo: "Mensual",
      pagoDia: 31,
      proximo: "31 de agosto de 2025",
      concursos: [
        { titulo: "Premio Nacional 2024", link: "https://ejemplo.com/concurso1" },
        { titulo: "Fotograf√≠a Anual", link: "https://ejemplo.com/concurso2" }
      ]
    }
  };

  const userBar = document.getElementById("userBar");
  const authBar = document.getElementById("authBar");
  const loginToggle = document.getElementById("loginToggle");
  const emailInput = document.getElementById("emailInput");
  const submitLogin = document.getElementById("submitLogin");
  const closeLoginBtn = document.getElementById("closeLoginBtn");
  const loginError = document.getElementById("loginError");
  const errorMessage = document.getElementById("errorMessage");
  const userName = document.getElementById("userName");
  const subscribeButton = document.getElementById("subscribeButton");
  const infoBtn = document.getElementById("infoBtn");

  let loggedIn = false;

  function checkScroll() {
    if (window.innerWidth <= 768) {
      authBar.classList.add("visible");
      userBar.classList.toggle("visible", loggedIn);
    } else {
      const scrollY = window.scrollY;
      if (scrollY > 150) {
        authBar.classList.add("visible");
        if (loggedIn) userBar.classList.add("visible");
      } else {
        authBar.classList.remove("visible");
        userBar.classList.remove("visible");
      }
    }
  }

  function loadFromCache() {
    const user = JSON.parse(localStorage.getItem("user"));
    if (user && localStorage.getItem("logged") === "true") {
      userName.textContent = `Hola, ${user.nombre}`;
      loggedIn = true;
      authBar.classList.remove("visible");
      userBar.style.display = "flex";
      userBar.classList.add("visible");
    }
  }

  function expandLogin() {
    loginToggle.classList.add("hidden");
    emailInput.style.display = "block";
    submitLogin.style.display = "flex";
    closeLoginBtn.style.display = "flex";
    subscribeButton.classList.add("hidden");
    infoBtn.classList.add("hidden");
    emailInput.focus();
  }

  function resetLoginState() {
    loginToggle.classList.remove("hidden");
    emailInput.style.display = "none";
    submitLogin.style.display = "none";
    closeLoginBtn.style.display = "none";
    subscribeButton.classList.remove("hidden");
    infoBtn.classList.remove("hidden");
    loginError.style.display = "none";
    emailInput.value = "";
  }

  function showError(msg) {
    loginError.style.display = "flex";
    errorMessage.textContent = msg;
    emailInput.style.display = "none";
    submitLogin.style.display = "none";
    closeLoginBtn.style.display = "none";
    loginToggle.classList.add("hidden");
    subscribeButton.classList.remove("hidden");
    infoBtn.classList.remove("hidden");
  }

  function login() {
    const email = emailInput.value.trim().toLowerCase();
    const user = users[email];
    if (!email) return showError("Ingres√° un correo electr√≥nico.");
    if (!user) return showError("Correo no registrado.");
    if (user.estado !== "activo") return showError("Cuenta suspendida. Contact√° soporte.");
    
    userName.textContent = `Hola, ${user.nombre}`;
    localStorage.setItem("logged", "true");
    localStorage.setItem("user", JSON.stringify(user));
    loggedIn = true;
    userBar.style.display = "flex";
    userBar.classList.add("visible");
    authBar.classList.remove("visible");
  }

  function logout() {
    localStorage.removeItem("logged");
    localStorage.removeItem("user");
    loggedIn = false;
    userBar.style.display = "none";
    userBar.classList.remove("visible");
    authBar.classList.add("visible");
    resetLoginState();
  }

  function viewAccount() {
    alert("Funcionalidad de cuenta: En construcci√≥n");
  }

  loginToggle.addEventListener("click", expandLogin);
  submitLogin.addEventListener("click", login);
  closeLoginBtn.addEventListener("click", resetLoginState);

  emailInput.addEventListener("keydown", e => {
    if (e.key === "Enter") login();
    else if (e.key === "Escape") resetLoginState();
  });

  window.addEventListener("scroll", checkScroll);
  window.addEventListener("resize", checkScroll);

  loadFromCache();
  checkScroll();
</script>

</body>
</html>
