<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Barra Flotante con Panel Mi Cuenta - Reescrito</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: Arial, sans-serif; background: #fefefe; }

    /* ---------- BARRA FLOTANTE ---------- */
    .barra-flotante {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 50px;
      background-color: #f68e03;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0 11px; /* escritorio: padding lateral estándar */
      z-index: 9999;
      user-select: none;
      overflow: hidden;
    }

    /* Contenido de la barra: en desktop quitamos márgenes laterales excesivos.
       Se mantiene anchura total para evitar márgenes visuales */ 
    .barra-contenido {
      width: 100%;
      max-width: 100%; /* quitamos el max-width pequeño para eliminar márgenes */
      margin: 0; /* sin márgenes laterales en escritorio */
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: relative;
      height: 100%;
      padding-left: 0;  /* sin padding lateral en desktop */
      padding-right: 0;
    }

    /* Grupo de botones: permitimos scroll horizontal si excede la pantalla.
       Esto aplica a la fila principal de botones (izquierda/derecha). */
    .grupo-botones {
      display: flex;
      align-items: center;
      gap: 6px;
      height: 100%;
      flex-wrap: nowrap;
      white-space: nowrap;
      overflow-x: auto; /* scroll horizontal si excede ancho */
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
    }

    .btn {
      background-color: #bb6c00;
      color: #fff;
      border: none;
      padding: 6px 10px;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      height: 32px; /* Igual alto para todos los botones (escritorio) */
      display: flex;
      align-items: center;
      text-decoration: none;
      transition: background 0.3s ease;
      white-space: nowrap;
      box-sizing: border-box;
      flex-shrink: 0;
    }
    .btn:hover { background-color: #a55a00; text-decoration: none; }

    /* Específicos: en escritorio aplicar margen derecho de 7px a Ayuda y Cerrar sesión */
    .ayuda-btn, .cerrar-sesion-btn { margin-right: 7px; }
    @media (max-width: 600px) {
      /* En móviles no queremos ese margen extra a la derecha */
      .ayuda-btn, .cerrar-sesion-btn { margin-right: 0; }
    }

    /* Popup login */
    .popup-login {
      position: absolute;
      top: 50px;
      left: 0;
      right: 0;
      height: 50px;
      background-color: #f68e03;
      display: none;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 0 10px;
      animation: fadeIn 0.3s ease;
      z-index: 10000;
      user-select: auto;
      flex-wrap: wrap; /* permite adaptar el ancho del input y que el mensaje de error pase a la siguiente línea cuando sea necesario */
    }
    .popup-login input {
      padding: 6px;
      border-radius: 4px;
      border: none;
      font-size: 14px;
      /* hacer el campo de correo más largo pero adaptable cuando aparezcan mensajes de error */
      flex: 1 1 320px; /* crecer/encoger según espacio; base 320px en escritorio */
      min-width: 180px;
      max-width: 520px;
      box-sizing: border-box;
    }

    /* Nuevo contenedor de mensaje de error (se muestra diferentes posiciones según viewport).
       En móvil se mostrará POR ENCIMA del popup, con opción de cerrar dentro del propio mensaje,
       en color rojo y del mismo alto que los botones. En escritorio seguirá comportándose
       como un mensaje inline/block bajo el popup si se desea (pero por defecto oculto). */
    .mensaje-error {
      display: none;
      color: white;
      background-color: red;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 13px;
      box-sizing: border-box;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      flex-shrink: 0;
    }
    .mensaje-error .texto-error { display: inline-block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .mensaje-error .error-close { background: transparent; border: none; color: white; font-weight: 700; cursor: pointer; font-size: 16px; padding: 4px 8px; border-radius: 4px; }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* ---------- PANEL MI CUENTA ---------- */
    #panelMiCuenta {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50px;
      color: white;
      display: none; /* oculto por defecto */
      align-items: center;
      gap: 10px;
      padding: 0 0; /* escritorio: sin espaciados laterales cuando se muestra Mi cuenta (cambio solicitado) */
      white-space: nowrap;
      font-size: 14px;
      overflow: hidden; /* por defecto oculto; las secciones internas controlan scroll */
      transition: opacity 0.35s ease, transform 0.25s ease;
      user-select: none;
      z-index: 10000;
      background: transparent;
    }
    #panelMiCuenta.visible { display: flex; opacity: 1; }

    /* Wrapper interno: permitimos scroll horizontal para la mayoría de secciones */
    .panel-inner {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      overflow-x: auto; /* permite scroll horizontal cuando el contenido supera el ancho */
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
      white-space: nowrap;
    }

    /* Botones del panel (mantener funcionalidad y apariencia) */
    #panelMiCuenta .btn-panel {
      background-color: #bb6c00;
      color: #fff;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      transition: background-color 0.25s ease;
      white-space: nowrap;
      text-decoration: none !important;
      height: 32px;
      box-sizing: border-box;
    }
    #panelMiCuenta .btn-panel:hover { background-color: #a55a00; }

    .foto-usuario {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 6px;
      flex-shrink: 0;
    }

    /* Contenedor usuario y datos.
       Importante: nombre y apellido estarán en negrita (clases .nombre-bold y .apellido-bold),
       el resto no, pero todo con el mismo tamaño de letra y alineado. */
    .usuario-detalle { display: flex; align-items: center; gap: 8px; white-space: nowrap; }
    .usuario-datos { display: flex; gap: 15px; font-size: 14px; color: white; white-space: nowrap; align-items: center; }

    .usuario-texto { font-size: 14px; color: white; display: flex; align-items: center; gap: 6px; }
    /* nueva clase para wrapper de nombre y apellido: quitar espacio entre ellos */
    .nombre-apellido-wrapper { gap: 0; display: flex; align-items: center; }
    .nombre-bold { font-weight: 700; margin-right: 0; } /* eliminar margen derecho adicional */
    .apellido-bold { font-weight: 700; }
    .usuario-resto { font-weight: 400; } /* resto no en negrita */

    /* Contenedor de contenido exclusivo.
       Según tu pedido, EL CONTENIDO EXCLUSIVO NO debe poder hacer scroll (excepción). */
    .contenedor-exclusivo {
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
      flex-grow: 1;
      justify-content: flex-start;
      overflow: visible; /* no hacer scroll aquí (excepción solicitada) */
    }

    .flecha {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      user-select: none;
      flex-shrink: 0;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 32px;
      box-sizing: border-box;
    }
    .flecha:hover { background: rgba(255,255,255,0.35); }

    .articulo-exclusivo {
      min-width: 200px;
      padding: 6px 10px;
      background: rgba(255,255,255,0.15);
      border-radius: 4px;
      display: flex;
      align-items: center;
      margin-left: 0;
      margin-right: 0;
      justify-content: flex-start;
      overflow: hidden; /* dentro del artículo se ocultan excedentes en texto */
    }
    .articulo-exclusivo a {
      color: white;
      text-decoration: none;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      flex-shrink: 1;
    }
    .articulo-exclusivo a:hover { text-decoration: underline; }

    .badge {
      background: rgba(255,255,255,0.18);
      color: white;
      font-weight: 700;
      padding: 4px 8px;
      border-radius: 12px;
      margin-right: 8px;
      flex-shrink: 0;
      font-size: 12px;
    }

    .back-wrapper { display: flex; align-items: center; margin-left: 10px; }

    /* Evitar scrollbars no deseadas en panel en escritorio */
    #panelMiCuenta::-webkit-scrollbar { height: 6px; }
    #panelMiCuenta::-webkit-scrollbar-thumb { background: rgba(255 255 255 / 0.3); border-radius: 3px; }

    /* ---------- ADAPTACIONES MÓVILES ---------- */
    @media (max-width: 600px) {
      /* Quitar 2px de espaciado en los laterales derecho e izquierdo de la barra en versión móvil */
      /* (desktop: 11px -> móvil: 9px) */
      .barra-flotante { padding: 0 9px; }

      .btn { font-size: 13px; padding: 5px 8px; height: 28px; }
      .popup-login input { flex-basis: 220px; min-width: 120px; }
      #panelMiCuenta { font-size: 13px; padding: 0 10px; } /* en móvil mantenemos padding lateral */
      #panelMiCuenta .btn-panel { padding: 5px 8px; height: 28px; }
      .barra-contenido { padding-left: 11px; padding-right: 11px; } /* coherencia visual interna */
      .usuario-datos { font-size: 13px; }

      #panelMiCuenta.visible { display: flex; padding-left: 10px; padding-right: 10px; }
      .panel-inner { gap: 8px; }

      /* Contenedor exclusivo: mantendremos que NO haga scroll (excepción) y que se muestre correctamente */
      .contenedor-exclusivo { min-width: 0; flex: 1 1 auto; overflow: visible; }

      .articulo-exclusivo {
        min-width: 0;
        width: 100%;
        padding: 8px 10px;
        border-radius: 6px;
      }
      .articulo-exclusivo a { white-space: normal; }

      /* Back wrapper a la derecha en móvil */
      .back-wrapper { margin-left: auto; }

      .flecha { padding: 8px 10px; min-width: 40px; }
      .badge { margin-right: 8px; flex-shrink: 0; }

      /* OCULTAR la barra de scroll en móvil para scrolls horizontales:
         esto permite hacer swipe/scroll horizontal sin que la barra sea visible. */
      .panel-inner::-webkit-scrollbar,
      .grupo-botones::-webkit-scrollbar {
        display: none;
        width: 0;
        height: 0;
      }
      .panel-inner { -ms-overflow-style: none; scrollbar-width: none; }
      .grupo-botones { -ms-overflow-style: none; scrollbar-width: none; }

      /* En móvil mostramos el mensaje de error POR ENCIMA del popup (no debajo).
         Se ajusta su alto para que coincida con el alto de los botones móviles (28px). */
      .popup-login { padding-top: 34px; /* espacio para el mensaje absoluto cuando aparece */ }
      .mensaje-error {
        position: absolute;
        bottom: calc(100% + 6px); /* encima del popup */
        left: 6px;
        right: 6px;
        height: 28px; /* mismo alto que los botones en móvil */
        display: none;
        align-items: center;
        justify-content: space-between;
        background-color: #d32f2f;
        color: white;
        border-radius: 6px;
        padding: 0 8px;
        font-size: 13px;
      }
      .mensaje-error .texto-error { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
      .mensaje-error .error-close { font-size: 16px; padding: 4px 6px; color: white; }

      /* En escritorio, si se quisiera mostrar el mensaje se mantiene inline-block bajo el popup */
      .popup-login .mensaje-error.desktop-inline {
        position: static;
        height: auto;
        display: none;
        margin-top: 6px;
        border-radius: 4px;
        padding: 5px 10px;
        font-size: 13px;
      }
    }

    /* Compatibilidad: ocultar scroll visual en iOS/Android cuando requerido */
    @supports (-webkit-overflow-scrolling: touch) {
      .panel-inner, .grupo-botones { -webkit-overflow-scrolling: touch; }
    }
  </style>
</head>
<body>

  <div class="barra-flotante">
    <div class="barra-contenido" id="barraContenido">
      <div class="grupo-botones" id="izquierda">
        <button class="btn" id="btnIniciarSesion" onclick="mostrarLogin()">Iniciar sesión</button>
        <span id="saludoUsuario" style="color:white; font-weight:bold; display:flex; align-items:center; gap:6px;"></span>
      </div>

      <div class="grupo-botones" id="centro" style="justify-content:center; flex: 1 1 auto;">
        <!-- Aquí puede ir contenido central si se requiere, se mantiene scroll horizontal si excede -->
      </div>

      <div class="grupo-botones" id="derecha" style="justify-content:flex-end;">
        <a href="https://www.prenoticia.com/p/suscribirme-prenoticia.html" class="btn" target="_blank">Suscribirme</a>
        <a href="https://www.prenoticia.com/mi-cuenta-ayuda" class="btn ayuda-btn" target="_blank">Ayuda</a>
      </div>

      <!-- Panel Mi Cuenta (se inyecta por JS) -->
      <div id="panelMiCuenta"></div>

      <div class="popup-login" id="popupLogin" aria-hidden="true">
        <!-- Mensaje de error: contenedor reutilizable. En móvil se posiciona por encima del popup;
             en escritorio puede usarse la clase desktop-inline si se quiere mostrar debajo. -->
        <div class="mensaje-error" id="mensajeError">
          <span class="texto-error" id="mensajeErrorText"></span>
          <button class="error-close" id="btnCerrarError" aria-label="Cerrar mensaje">✕</button>
        </div>

        <input type="email" id="inputEmail" placeholder="Tu correo" />
        <button class="btn" onclick="validarEmail()">Ingresar</button>
        <button class="btn" onclick="cerrarLogin()">✕</button>
      </div>
    </div>
  </div>

  <script>
    /* ---------- DATOS DE USUARIOS (tal cual estaban) ---------- */
    const usuarios = {
      "mauricioacostacom@gmail.com": {
        activo: true,
        nombre: "Mauricio David",
        apellido: "Acosta Danaher",
        email: "mauricioacostacom@gmail.com",
        medioPago: "Mercado Pago",
        ultimoPago: "31 de julio de 2025",
        proximoPago: "31 de septiembre de 2025",
        pais: "Buenos Aires, Argentina",
        emailVerificado: true,
        foto: "https://pbs.twimg.com/profile_images/1907511710769930240/7oUtDTMv_400x400.jpg",
        articulos: [
          { titulo: "Submarino desaparece en la Antártida tras descubrir estructuras desconocidas", url: "https://www.prenoticia.com/2025/08/submarino-desaparece-en-la-antartida.html" },
          { titulo: "Un informe reciente señala que no hace falta caminar tantos pasos como se creía para cuidar la salud", url: "https://www.prenoticia.com/2025/08/un-informe-reciente-senala-que-no-hace.html" },
          { titulo: "El cerebro del hombre es más grande, pero el de la mujer funciona con más eficiencia", url: "https://www.prenoticia.com/2025/06/el-cerebro-del-hombre-es-mas-grande.html" },
          { titulo: "¡Ganá una suscripción anual! Participá del sorteo exclusivo", url: "https://www.prenoticia.com/sorteo-2025", tipo: "sorteo" },
          { titulo: "Código exclusivo: 10% de descuento en Prenoticia", url: "https://www.prenoticia.com/codigo-descuento", tipo: "codigo" }
        ]
      },
      "luciacarpio20@gmail.com": {
        activo: false,
        nombre: "Maria",
        apellido: "Carpio Peralta",
        email: "luciacarpio20@gmail.com",
        deuda: "$1.000",
        foto: ""
      }
    };

    /* ---------- Estado global ---------- */
    let panelEstado = "cerrado";
    let usuarioActual = null;
    let articuloIndex = 0;

    const btnIniciarSesion = document.getElementById("btnIniciarSesion");
    const saludoUsuario = document.getElementById("saludoUsuario");
    const popupLogin = document.getElementById("popupLogin");
    const mensajeError = document.getElementById("mensajeError");
    const mensajeErrorText = document.getElementById("mensajeErrorText");
    const btnCerrarError = document.getElementById("btnCerrarError");
    const inputEmail = document.getElementById("inputEmail");
    const panelMiCuenta = document.getElementById("panelMiCuenta");
    const derecha = document.getElementById("derecha");
    const izquierda = document.getElementById("izquierda");
    const centro = document.getElementById("centro");

    /* ---------- Funciones UI (manteniendo la funcionalidad original) ---------- */

    function mostrarLogin() {
      // ocultar cualquier mensaje de error previo
      ocultarMensajeError();
      popupLogin.style.display = "flex";
      popupLogin.setAttribute('aria-hidden','false');
      inputEmail.focus();
    }
    function cerrarLogin() {
      ocultarMensajeError();
      popupLogin.style.display = "none";
      popupLogin.setAttribute('aria-hidden','true');
      inputEmail.value = "";
    }

    function mostrarMensajeError(text) {
      // Colocar el texto y mostrar el contenedor de error.
      mensajeErrorText.textContent = text;
      mensajeError.style.display = "flex";

      // Asegurarse que el input quede accesible para reingreso
      inputEmail.focus();
    }

    function ocultarMensajeError() {
      mensajeError.style.display = "none";
      mensajeErrorText.textContent = "";
    }

    btnCerrarError.addEventListener('click', function(e){
      e.preventDefault();
      ocultarMensajeError();
      inputEmail.focus();
    });

    function validarEmail() {
      const email = inputEmail.value.trim().toLowerCase();
      ocultarMensajeError(); // limpiar cualquier mensaje antes de validar

      if (!email) {
        // Si está vacío, mostrar mensaje (en móvil aparecerá por encima)
        mostrarMensajeError("Por favor, ingresá tu correo electrónico");
        return;
      }
      if (usuarios[email]) {
        if (usuarios[email].activo) {
          localStorage.setItem("usuarioLogueado", email);
          cargarSesion(usuarios[email]);
          cerrarLogin();
        } else {
          // mostrar el mensaje de deuda (en móvil aparecerá por encima y con opción de cerrar)
          mostrarMensajeError(`Tu cuenta registra una deuda impaga de ${usuarios[email].deuda}.`);
          return;
        }
      } else {
        mostrarMensajeError("El correo ingresado no está suscripto.");
        return;
      }
    }

    function cargarSesion(usuario) {
      usuarioActual = usuario;
      btnIniciarSesion.style.display = "none";
      saludoUsuario.innerHTML = "";
      if (usuario.foto) {
        const img = document.createElement("img"); img.src = usuario.foto; img.className = "foto-usuario"; saludoUsuario.appendChild(img);
      }
      const primerNombre = usuario.nombre.split(" ")[0];
      saludoUsuario.appendChild(document.createTextNode(primerNombre));
      derecha.innerHTML = "";

      const btnCuenta = document.createElement("button");
      btnCuenta.textContent = "Mi cuenta";
      btnCuenta.className = "btn";
      btnCuenta.onclick = () => { if (panelEstado === "cerrado") mostrarPanelInicio(); else if (panelEstado === "inicio") ocultarPanel(); };
      derecha.appendChild(btnCuenta);

      const btnCerrarSesion = document.createElement("button");
      btnCerrarSesion.textContent = "Cerrar sesión";
      btnCerrarSesion.className = "btn cerrar-sesion-btn"; /* clase añadida para margen derecho en escritorio */
      btnCerrarSesion.onclick = () => { localStorage.removeItem("usuarioLogueado"); location.reload(); };
      derecha.appendChild(btnCerrarSesion);

      ocultarPanel();
    }

    function mostrarPanelInicio() {
      panelEstado = "inicio";
      construirPanelInicio();
      derecha.style.display = "none";
      izquierda.style.display = "none";
      centro.style.display = "none";
      panelMiCuenta.classList.add("visible");
    }

    function construirPanelInicio() {
      panelMiCuenta.innerHTML = "";

      const inner = document.createElement('div');
      inner.className = 'panel-inner';

      const acciones = document.createElement('div');
      acciones.style.display = 'flex';
      acciones.style.gap = '8px';
      acciones.style.alignItems = 'center';

      const btnNombre = document.createElement("button");
      btnNombre.className = "btn-panel";
      btnNombre.textContent = "Usuario";
      btnNombre.onclick = () => { construirDetalle("nombre"); };
      acciones.appendChild(btnNombre);

      const btnExclusivo = document.createElement("button");
      btnExclusivo.className = "btn-panel";
      btnExclusivo.textContent = "Contenido exclusivo";
      btnExclusivo.onclick = () => { construirExclusivo(); };
      acciones.appendChild(btnExclusivo);

      const btnMetodo = document.createElement("button");
      btnMetodo.className = "btn-panel";
      btnMetodo.textContent = "Método de pago";
      btnMetodo.onclick = () => { construirDetalle("metodoPago"); };
      acciones.appendChild(btnMetodo);

      const btnFechas = document.createElement("button");
      btnFechas.className = "btn-panel";
      btnFechas.textContent = "Próximas fechas de pago";
      btnFechas.onclick = () => { construirDetalle("proximosPagos"); };
      acciones.appendChild(btnFechas);

      const btnBaja = document.createElement("a");
      btnBaja.className = "btn-panel";
      btnBaja.style.textDecoration = "none";
      btnBaja.textContent = "Dar de baja suscripción";
      btnBaja.href = "https://www.prenoticia.com/baja-suscripción";
      btnBaja.target = "_blank";
      acciones.appendChild(btnBaja);

      const btnAyuda = document.createElement("a");
      btnAyuda.className = "btn-panel ayuda-btn"; /* clase añadida para margen derecho en escritorio */
      btnAyuda.textContent = "Ayuda";
      btnAyuda.href = "https://www.prenoticia.com/mi-cuenta-ayuda";
      btnAyuda.target = "_blank";
      acciones.appendChild(btnAyuda);

      inner.appendChild(acciones);

      const backWrap = document.createElement('div');
      backWrap.className = 'back-wrapper';
      inner.appendChild(backWrap);

      panelMiCuenta.appendChild(inner);

      construirBotonVolverInContainer(backWrap);
    }

    function construirExclusivo() {
      panelEstado = "detalle";
      panelMiCuenta.innerHTML = "";

      if (!usuarioActual || !usuarioActual.articulos) {
        panelMiCuenta.textContent = "No hay contenido exclusivo disponible.";
        construirBotonVolver();
        return;
      }

      const inner = document.createElement('div');
      inner.className = 'panel-inner';

      const cont = document.createElement("div");
      cont.className = "contenedor-exclusivo";

      const flechaIzq = document.createElement("button");
      flechaIzq.className = "flecha";
      flechaIzq.textContent = "<";
      flechaIzq.onclick = () => { articuloIndex = (articuloIndex - 1 + usuarioActual.articulos.length) % usuarioActual.articulos.length; mostrarArticulo(); };

      const flechaDer = document.createElement("button");
      flechaDer.className = "flecha";
      flechaDer.textContent = ">";
      flechaDer.onclick = () => { articuloIndex = (articuloIndex + 1) % usuarioActual.articulos.length; mostrarArticulo(); };

      const articuloDiv = document.createElement("div");
      articuloDiv.className = "articulo-exclusivo";

      const badge = document.createElement('span');
      badge.className = 'badge';

      const enlace = document.createElement("a");
      enlace.target = "_blank";

      cont.appendChild(flechaIzq);
      cont.appendChild(flechaDer);
      articuloDiv.appendChild(badge);
      articuloDiv.appendChild(enlace);
      cont.appendChild(articuloDiv);

      inner.appendChild(cont);

      const backWrap = document.createElement('div');
      backWrap.className = 'back-wrapper';
      inner.appendChild(backWrap);

      panelMiCuenta.appendChild(inner);

      construirBotonVolverInContainer(backWrap);

      function mostrarArticulo() {
        const art = usuarioActual.articulos[articuloIndex];
        enlace.href = art.url;
        enlace.textContent = art.titulo;
        if (art.tipo === 'sorteo') badge.textContent = 'SORTEO';
        else if (art.tipo === 'codigo') badge.textContent = 'CÓDIGO';
        else if (art.tipo === 'exclusivo') badge.textContent = 'EXCLUSIVO';
        else badge.textContent = '';
        badge.style.display = badge.textContent ? 'inline-flex' : 'none';
      }

      mostrarArticulo();
    }

    function construirDetalle(tipo) {
      panelEstado = "detalle";
      panelMiCuenta.innerHTML = "";
      if (!usuarioActual) return;

      const inner = document.createElement('div');
      inner.className = 'panel-inner';

      const contenido = document.createElement('div');
      contenido.style.display = 'flex';
      contenido.style.alignItems = 'center';
      contenido.style.gap = '8px';

      if (tipo === "nombre") {
        const contUsuario = document.createElement("div");
        contUsuario.className = "usuario-detalle";

        if (usuarioActual.foto) {
          const img = document.createElement("img"); img.src = usuarioActual.foto; img.className = "foto-usuario"; contUsuario.appendChild(img);
        }

        /* NOMBRE y APELLIDO en negrita (separados) + resto no en negrita,
           todos alineados y con mismo tamaño de letra, como solicitaste. */
        const nombreApellidoWrapper = document.createElement('div');
        nombreApellidoWrapper.className = 'usuario-texto nombre-apellido-wrapper'; /* wrapper con gap:0 para eliminar espacio entre nombre y apellido */

        const nombreSpan = document.createElement('span');
        nombreSpan.className = 'nombre-bold';
        nombreSpan.textContent = usuarioActual.nombre || '';

        const apellidoSpan = document.createElement('span');
        apellidoSpan.className = 'apellido-bold';
        apellidoSpan.textContent = usuarioActual.apellido || '';

        nombreApellidoWrapper.appendChild(nombreSpan);
        nombreApellidoWrapper.appendChild(apellidoSpan);

        contUsuario.appendChild(nombreApellidoWrapper);

        contenido.appendChild(contUsuario);

        const datos = document.createElement("div"); datos.className = "usuario-datos";
        const emailSpan = document.createElement("span"); emailSpan.className = 'usuario-resto'; emailSpan.textContent = usuarioActual.email || ''; datos.appendChild(emailSpan);
        const verificadoSpan = document.createElement("span"); verificadoSpan.className = 'usuario-resto'; verificadoSpan.textContent = usuarioActual.emailVerificado ? "✅ Email verificado" : "❌ Email no verificado"; datos.appendChild(verificadoSpan);
        const paisSpan = document.createElement("span"); paisSpan.className = 'usuario-resto'; paisSpan.textContent = usuarioActual.pais || ""; datos.appendChild(paisSpan);
        contenido.appendChild(datos);
      }
      if (tipo === "metodoPago") {
        const texto = document.createElement('div');
        texto.className = 'usuario-resto';
        texto.textContent = `Método de pago: ${usuarioActual.medioPago || "No especificado"}`;
        contenido.appendChild(texto);
      }
      if (tipo === "proximosPagos") {
        const texto = document.createElement('div');
        texto.className = 'usuario-resto';
        texto.innerHTML = `Último pago: <b>${usuarioActual.ultimoPago || "No disponible"}</b> &nbsp; Próximo pago: <b>${usuarioActual.proximoPago || "No disponible"}</b>`;
        contenido.appendChild(texto);
      }

      inner.appendChild(contenido);

      const backWrap = document.createElement('div'); backWrap.className = 'back-wrapper'; inner.appendChild(backWrap);

      panelMiCuenta.appendChild(inner);

      construirBotonVolverInContainer(backWrap);
    }

    function construirBotonVolverInContainer(container) {
      container.innerHTML = '';
      const btnVolver = document.createElement("button");
      btnVolver.className = "btn-panel";
      btnVolver.textContent = "← Volver";
      btnVolver.onclick = () => { if (panelEstado === "detalle") mostrarPanelInicio(); else if (panelEstado === "inicio") ocultarPanel(); };
      container.appendChild(btnVolver);
    }

    function construirBotonVolver() {
      const btnVolver = document.createElement("button");
      btnVolver.className = "btn-panel";
      btnVolver.textContent = "← Volver";
      btnVolver.style.marginLeft = "10px";
      btnVolver.onclick = () => { if (panelEstado === "detalle") mostrarPanelInicio(); else if (panelEstado === "inicio") ocultarPanel(); };
      panelMiCuenta.appendChild(btnVolver);
    }

    function ocultarPanel() {
      panelMiCuenta.classList.remove("visible");
      panelMiCuenta.innerHTML = "";
      panelEstado = "cerrado";
      derecha.style.display = "flex";
      izquierda.style.display = "flex";
      centro.style.display = "flex";
    }

    window.onload = () => {
      const emailGuardado = localStorage.getItem("usuarioLogueado");
      if (emailGuardado && usuarios[emailGuardado] && usuarios[emailGuardado].activo) { cargarSesion(usuarios[emailGuardado]); }
    };
  </script>

</body>
</html>
 
